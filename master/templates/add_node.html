{% extends "base.html" %}

{% block title %}添加节点 - Xray 集群管理系统{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('index') }}">首页</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('node_list') }}">节点管理</a></li>
                <li class="breadcrumb-item active">添加节点</li>
            </ol>
        </nav>

        <div class="card">
            <div class="card-header">
                <h4 class="card-title mb-0">
                    <i class="fas fa-plus-circle"></i> 添加新节点
                </h4>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('add_node') }}">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">
                                <i class="fas fa-tag"></i> 节点名称 *
                            </label>
                            <input type="text" class="form-control" id="name" name="name" required
                                   placeholder="例如: 香港节点-01">
                            <div class="form-text">便于识别的节点名称</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="domain" class="form-label">
                                <i class="fas fa-globe"></i> 节点域名 *
                            </label>
                            <input type="text" class="form-control" id="domain" name="domain" required
                                   placeholder="例如: node1.example.com">
                            <div class="form-text">节点的完整域名，必须已解析到服务器 IP</div>
                        </div>
                    </div>
                    
                    <div class="card mb-3">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">
                                <i class="fas fa-plug"></i> 协议配置（可在创建后修改）
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="vless_enabled" name="vless_enabled" checked>
                                <label class="form-check-label" for="vless_enabled">
                                    <span class="badge bg-primary">VLESS</span> XTLS-Vision（主力协议）
                                </label>
                            </div>
                            
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="split_http_enabled" name="split_http_enabled" checked>
                                <label class="form-check-label" for="split_http_enabled">
                                    <span class="badge bg-info">SplitHTTP</span> HTTP 伪装（CDN 友好）
                                </label>
                            </div>
                            
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="hysteria2_enabled" name="hysteria2_enabled" checked>
                                <label class="form-check-label" for="hysteria2_enabled">
                                    <span class="badge bg-warning">Hysteria2</span> 高速 UDP 协议
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6><i class="fas fa-info-circle"></i> 安装说明</h6>
                        <p class="mb-0 small">
                            节点创建后，需要在目标服务器上运行 Node 安装脚本。<br>
                            系统会自动生成 UUID 和配置，节点安装时会自动注册到本面板。
                        </p>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('node_list') }}" class="btn btn-outline-secondary me-md-2">
                            <i class="fas fa-times"></i> 取消
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-check"></i> 创建节点
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-terminal"></i> 节点安装命令
                </h5>
            </div>
            <div class="card-body">
                <p>在节点服务器上执行以下命令：</p>
                <div class="bg-dark text-light p-3 rounded mb-3">
                    <code class="text-light">curl -fsSL https://raw.githubusercontent.com/your-repo/install.sh | sudo bash</code>
                </div>
                <p class="small text-muted mb-0">
                    选择 "安装 Node 节点"，然后输入集群密钥和节点域名即可。
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}